<!DOCTYPE html>
<html>
<head>
    <title>SOC Monitor</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>Status Atual dos Hosts</h1>
    <ul>
        {% for host, online in status.items %}
            <li>{{ host.nome }} ({{ host.ip }}) - <strong>{{ "Online" if online else "Offline" }}</strong></li>
        {% endfor %}
    </ul>

    <h2>Histórico das Últimas 12h</h2>
    {% for host_nome, eventos in historico.items %}
        <h3>{{ host_nome }}</h3>
        <canvas id="chart-{{ forloop.counter }}" width="400" height="100"></canvas>
        <script>
            const ctx{{ forloop.counter }} = document.getElementById('chart-{{ forloop.counter }}').getContext('2d');
            new Chart(ctx{{ forloop.counter }}, {
                type: 'line',
                data: {
                    labels: [{% for e in eventos %}'{{ e.horario|date:"H:i" }}',{% endfor %}],
                    datasets: [{
                        label: 'Status (1=Online, 0=Offline)',
                        data: [{% for e in eventos %}{{ 1 if e.online else 0 }},{% endfor %}],
                        fill: false,
                        borderColor: 'rgb(75, 192, 192)',
                        tension: 0.1
                    }]
                },
            });
        </script>
    {% endfor %}
</body>
</html>
